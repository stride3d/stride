<xk:ModalWindow x:Class="Xenko.Assets.Presentation.Templates.UpdatePlatformsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xk="http://schemas.xenko.com/xaml/presentation"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:templates="clr-namespace:Xenko.Assets.Presentation.Templates"
        mc:Ignorable="d"
        Title="{xk:Localize Select platforms}" SizeToContent="Height" Width="480"
        Style="{DynamicResource WindowChromeStyle}" d:DataContext="{d:DesignInstance templates:UpdatePlatformsWindow}">
  <Window.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Xenko.Core.Assets.Editor;component/View/CommonResources.xaml"/>
        <ResourceDictionary Source="../View/ImageDictionary.xaml"/>
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
  </Window.Resources>
  <StackPanel>
    <Border Background="{StaticResource EmphasisColorBrush}" Margin="20,20,20,0">
      <TextBlock Text="Platforms" Margin="20,10" FontSize="16"/>
    </Border>
    <Border Margin="20,10,20,20">
      <ItemsControl ItemsSource="{Binding AvailablePlatforms}" Margin="10">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <StackPanel>
              <StackPanel Orientation="Horizontal">
                <Image Width="16" Height="16" Source="{Binding Platform, Converter={xk:StaticResourceConverter}}" Margin="0,0,4,0"/>
                <CheckBox Content="{Binding Name}" IsChecked="{Binding IsSelected, Mode=TwoWay}" IsEnabled="{Binding CanBeUnselected}"  Margin="5"/>
                <TextBlock Margin="4,0" Text="{xk:Localize (This will remove the project from the package and disk.)}" Visibility="{Binding MarkedToRemove, Mode=OneWay, Converter={xk:VisibleOrCollapsed}}" Foreground="OrangeRed" TextWrapping="Wrap"/>
              </StackPanel>
              <!-- TODO: The margin is a hack to align it with previous checkbox; this should be done differently (the checkbox content should be the stack panel with text + this?) -->
              <!-- Note: User can choose template only by deleting/reading the platform (we don't handle editing an existing one since we don't know the current template -->
              <!-- FIXME: UWP CoreWindow - temporarily disable template selection -->
              <!--<ComboBox ItemsSource="{Binding AvailableTemplates}" SelectedValue="{Binding SelectedTemplate}" Visibility="{xk:MultiBinding {Binding HasTemplates}, {Binding IsAlreadyInstalled, Converter={xk:InvertBool}}, Converter={xk:MultiChained {xk:AndMultiConverter}, {xk:VisibleOrCollapsed}}}" IsEnabled="{Binding IsSelected}" Margin="44,0,0,0" HorizontalAlignment="Left">
                <ComboBox.ItemTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding DisplayName}" Margin="4,0,0,0"/>
                  </DataTemplate>
                </ComboBox.ItemTemplate>
              </ComboBox>-->
              <DockPanel Margin="24,0,0,4" Visibility="{Binding IsAvailableOnMachine, Converter={xk:Chained {xk:InvertBool}, {xk:VisibleOrCollapsed}}}">
                <Image DockPanel.Dock="Left" Source="{StaticResource ImageWarning}" Height="16"/>
                <TextBlock Margin="4,0" Text="{xk:Localize This machine doesn\'t meet the requirements to build for this platform.}" FontSize="10" TextWrapping="Wrap"/>
              </DockPanel>
            </StackPanel>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </Border>
    <CheckBox Content="{xk:Localize Force regeneration of all platform projects, Context=Button}" IsChecked="{Binding ForcePlatformRegeneration, Mode=TwoWay}" Visibility="{Binding ForcePlatformRegenerationVisible, Converter={xk:VisibleOrCollapsed}}" Margin="20,0"/>
    <UniformGrid Rows="1" Margin="20">
      <Button Content="{xk:Localize OK, Context=Button}" Margin="0,0,20,0" Padding="8" Click="ButtonOk" IsDefault="True"/>
      <Button Content="{xk:Localize Cancel, Context=Button}" Padding="8" Click="ButtonCancel" IsCancel="True"/>
    </UniformGrid>
  </StackPanel>
</xk:ModalWindow>
